<task>
  <submodule>3.6: Interface de Transferência</submodule>
  <objective>
    Criar interface para transferir produtos entre locais, mantendo alta similaridade com as interfaces de entrada e saída de estoque (Sub-módulos 3.4 e 3.5), mas com funcionalidades específicas para transferência entre locais.
    - Reutilizar estrutura e padrões das páginas de entrada e saída de estoque
    - Adicionar seleção de local de origem e local de destino
    - Implementar verificação de estoque disponível no local de origem
    - Validar que locais de origem e destino sejam diferentes
    - Garantir que transferências não excedam estoque no local de origem
  </objective>

  <files>
    <!-- PÁGINA DE TRANSFERÊNCIA DE ESTOQUE -->
    <file type="frontend">
      <path>public/transferencia-estoque.html</path>
      <purpose>Página para transferência entre locais - estrutura similar às páginas de entrada e saída</purpose>
      <requirements>
        - Manter estrutura HTML muito similar à saida-estoque.html
        - Alterar título para "Transferência de Estoque"
        - Alterar formulário para incluir:
          * Select para Produto (obrigatório)
          * Select para Local de Origem (obrigatório)
          * Select para Local de Destino (obrigatório)
          * Input para Quantidade (obrigatório, número positivo)
        - Manter elemento para exibir estoque disponível no local de origem
        - Alterar texto do botão para "Transferir"
        - Preservar mesma organização de formulário e classes CSS
        - Incluir mesmo conjunto de scripts (auth.js, navbar.js, transferenciaEstoque.js)
        - Manter mesma estrutura de containers e layout
      </requirements>
    </file>

    <!-- LÓGICA JAVASCRIPT PARA TRANSFERÊNCIA -->
    <file type="frontend">
      <path>public/js/transferenciaEstoque.js</path>
      <purpose>Lógica para transferência - similar à saidaEstoque.js com adaptações para dois locais</purpose>
      <requirements>
        - Implementar mesmo fluxo de carregamento de produtos e locais
        - Manter mesma estrutura de validação básica de formulário
        - PRESERVAR mesmo padrão de consulta e exibição de estoque
        - ADICIONAR funcionalidades específicas para transferência:
          * Validar que local de origem e destino sejam diferentes
          * Consultar estoque apenas no local de origem (não no destino)
          * Bloquear envio se locais de origem e destino forem iguais
          * Manter verificação de estoque apenas no local de origem
        - Usar mesmo sistema de notificações para feedback
        - Manter mesma abordagem de prevenção de submissões duplicadas
        - Usar endpoint de transferência para submissão
      </requirements>
    </file>

    <!-- ATUALIZAÇÃO MENU NAVEGAÇÃO -->
    <file type="frontend">
      <path>public/index.html</path>
      <purpose>Adicionar transferência de estoque no menu de movimentações</purpose>
      <requirements>
        - No dropdown "Movimentações", adicionar item "Transferência de Estoque"
        - Link para transferencia-estoque.html
        - Manter mesma estilização dos itens existentes
      </requirements>
    </file>
  </files>

  <similarity_emphasis>
    <similar>Estrutura HTML: Muito similar à saida-estoque.html</similar>
    <similar>Carregamento inicial: Mesmas chamadas de API para produtos e locais</similar>
    <similar>Validação básica: Mesmas regras para campos obrigatórios</similar>
    <similar>Integração: Mesmo uso de auth.js, navbar.js, notify.js</similar>
    <similar>Padrões de código: Manter mesma organização e estilo</similar>
    <similar>Consulta de estoque: Mesma lógica da saída para local de origem</similar>
  </similarity_emphasis>

  <key_differences>
    <difference>
      <element>Dois campos de local</element>
      <description>Adicionar seleção para local de origem e local de destino</description>
    </difference>
    <difference>
      <element>Validação de locais diferentes</element>
      <description>Impedir que local de origem e destino sejam iguais</description>
    </difference>
    <difference>
      <element>Consulta de Estoque</element>
      <description>Consultar estoque apenas no local de origem (não no destino)</description>
    </difference>
    <difference>
      <element>Endpoint API</element>
      <description>Usar POST /api/movimentacoes/transferencia em vez de saída</description>
    </difference>
  </key_differences>

  <validation_rules>
    - Produto: obrigatório
    - Local origem: obrigatório
    - Local destino: obrigatório
    - Quantidade: obrigatória, positiva
    - Locais devem ser diferentes
    - Quantidade não pode exceder estoque no local de origem
  </validation_rules>

  <visual_feedback_specification>
    - Manter mesmo sistema de cores da saída para estoque no local de origem
    - Adicionar feedback visual para erro de locais iguais
    - Estados visuais aplicam-se apenas ao local de origem
    - Local destino não requer verificação de estoque
  </visual_feedback_specification>

  <api_integration>
    <existing_endpoints>
      - GET /api/produtos?status=Disponível (já existe)
      - GET /api/locais?status=Ativo (já existe)
      - GET /api/movimentacoes/estoque?produto_id=X&local_id=Y (já existe, usado para local de origem)
    </existing_endpoints>
    <modified_endpoint>
      - POST /api/movimentacoes/transferencia (já existe no backend)
    </modified_endpoint>
  </api_integration>

  <implementation_strategy>
    <step1>Copiar e adaptar saida-estoque.html para transferencia-estoque.html (adicionar segundo select para local destino)</step1>
    <step2>Copiar e adaptar saidaEstoque.js para transferenciaEstoque.js</step2>
    <step3>Implementar validação para locais diferentes</step3>
    <step4>Manter consulta de estoque apenas para local de origem</step4>
    <step5>Integrar com endpoint de transferência e testar fluxo completo</step5>
  </implementation_strategy>

  <dependencies>
    - Sub-módulo 3.5 completamente implementado (para referência principal)
    - Endpoint GET /api/movimentacoes/estoque já criado e funcionando
    - API de transferência funcionando (parte do Sub-módulo 3.2)
  </dependencies>

  <user_experience_flow>
    1. Usuário acessa página → carrega produtos/locais (igual à saída)
    2. Seleciona produto e local de origem → consulta e exibe estoque no local de origem (igual à saída)
    3. Seleciona local de destino → valida se é diferente do local de origem (DIFERENÇA)
    4. Digita quantidade → validação visual imediata (igual à saída, mas apenas para origem)
    5. Tenta enviar → validação final (estoque na origem e locais diferentes)
    6. Recebe feedback → notificação e limpeza (igual às anteriores)
  </user_experience_flow>

  <testing_focus>
    - Verificar que estrutura é similar à saída exceto pelas diferenças especificadas
    - Testar consulta de estoque ao mudar produto e local de origem
    - Validar que locais iguais impedem o envio
    - Confirmar que estoque no local de destino não é verificado
    - Testar estados visuais (aplicados apenas ao local de origem)
    - Garantir que notificações funcionam igual às anteriores
  </testing_focus>
</task>